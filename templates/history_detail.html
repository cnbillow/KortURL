{% extends 'base/base.html' %}
{% load static %}
{% block title %}详情{% endblock title %}
{% block extra_header %}
    <script src="{% static 'js/echarts.min.js' %}"></script>
{% endblock extra_header %}
{% block body_style %}style="background-color: #3498DB;margin-top: 50px;"{% endblock body_style %}

{% block body %}
    <div style="text-align: center;margin-bottom: 1%;">
        <h1>{{ code }}</h1>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div style="background-color: white;border-radius:15px;">
            <div id="views_count" style="height: 400px;"></div>
            </div>
        </div>
        <div class="col-md-6">
            <div style="background-color: white;border-radius:15px;">
            <div id="trend" style="height: 400px;"></div>
            </div>
        </div>
    </div>
<br>
    <div class="row">
        <div class="col-md-6">
            <div style="background-color: white;border-radius:15px;">
            <div id="device" style="height: 400px;"></div>
            </div>
        </div>
        <div class="col-md-6">
            <div style="background-color: white;border-radius:15px;">
            <div id="os" style="height: 400px;"></div>
            </div>
        </div>
    </div>
<br>
    <div class="row">
        <div class="col-md-6">
            <div id="browser" style="height: 400px;"></div>
        </div>
        <div class="col-md-6">
            <div id="isp" style="height: 400px;"></div>
        </div>
    </div>


{% endblock body %}

{% block extra_js %}
    <script>
        // 访问量
        var views_chart = echarts.init(document.getElementById('views_count'));
        var views_option = {
            title: {
                text: '访问量'
            },
            xAxis: {
                type: 'category',
                data: {{ view_dates | safe }},
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                data: {{ view_counts | safe }},
                type: 'line',
                symbol: 'circle',
                symbolSize: 20,
                color: '#3498DB'
            }]
        };
        views_chart.setOption(views_option);

        // 24小时访问趋势
        var trend_chart = echarts.init(document.getElementById('trend'));
        var trend_option = {
            title: {
                text: '今日24小时访问趋势'
            },
            xAxis: {
                type: 'category',
                data: {{ trend_hours | safe }},
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                data: {{ trend_counts | safe }},
                type: 'line',
                color: '#3498DB'
            }]
        };
        trend_chart.setOption(trend_option);

        // 设备
        var device_chart = echarts.init(document.getElementById('device'));
        var device_option = {
                title : {
                    text: '访问设备统计',
                    x:'center'
                },
                tooltip : {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                legend: {
                    type: 'scroll',
                    orient: 'vertical',
                    right: 10,
                    top: 20,
                    bottom: 20,
                    data: {{ device_names | safe }},

                    selected: {}
                },
                series : [
                    {
                        name: '设备',
                        type: 'pie',
                        radius : '55%',
                        center: ['40%', '50%'],
                        data: {{ device_data | safe }},
                        itemStyle: {
                            emphasis: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        },
                        color: '#3498DB'
                    }
                ]
            };
        device_chart.setOption(device_option);

        // 操作系统统计
        var os_chart = echarts.init(document.getElementById('os'));
        var os_option = {
                title : {
                    text: '操作系统统计',
                    x:'center'
                },
                tooltip : {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                legend: {
                    type: 'scroll',
                    orient: 'vertical',
                    right: 10,
                    top: 20,
                    bottom: 20,
                    data: {{ os_names | safe }},

                    selected: {}
                },
                series : [
                    {
                        name: '操作系统',
                        type: 'pie',
                        radius : '55%',
                        center: ['40%', '50%'],
                        data: {{ os_data | safe }},
                        itemStyle: {
                            emphasis: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        },
                        color: '#3498DB'
                    }
                ]
            };
        os_chart.setOption(os_option);
    </script>
{% endblock extra_js %}
{% block footer %}
{% endblock footer %}
